# lasape
front-end

## Building

### Pre-requisites

1. Node.js 
  * brew install node
  * npm install -g grunt-cli bower
2. Dependencies
  * npm install
  * sudo gem install bundler
  * bundle install

### Compiling

1. bundle exec grunt build
2. bundle exec grunt compass

### Development

1. bundle exec grunt

This will start a server on localhost:8000 and open it in a browser window.
Grunt will watch for file changes and update on the fly.

## Docker

### Building

1. docker build -t lasape .

### Running

1. docker run -p 80:80 lasape

Then point your browser to port 80 on your Docker host.

## Tools

Lasape utilizes a combination of technologies for eventual output.

### Grunt

Grunt is the central command for all tooling. Running grunt through bundle ensures correct ruby packages are in use.

### Bower

Bower is used for most of the dependencies such as Angular and Bootstrap. All libraries should be installed through bower and persisted to bower.json. The dependencies are installed to public/lib as dictated by .bowerrc. The exact files chosen for bundling into deps.min.js comes from the `uglify` grunt task. The only dependency that is not managed by bower is lodash, which is managed through npm.

### NPM

NPM manages dependencies for running the local dev server, running all `grunt` tasks, and for bundling [Slate](https://github.com/opsee/slate). Packages are persisted through package.json.

### Gemfile

The Gemfile persists all Ruby dependencies.

### Jekyll

Jekyll is used to create the base index.html and html emails. The src files are located in `/_site` and are generated on-the-fly.

### Browserify

Browserify is used to package Slate for use in Lasape. We run browserify through `grunt`.

### Babel

Babel is used to compile ES6 code to compatible ES5. The public/js/es6 files are watched during development and will compile to the matching public/js/src file.

### Swagger

Angular code meant to send requests to the api should be automatically generated by the swagger spec located at 
http://api-beta.opsee.co/api/swagger.json
The output file generated by the grunt task is at /public/js/src/api.js

### ng-annotate

We use [ng-annotate](https://github.com/olov/ng-annotate) to conform to the [dependency injection](https://docs.angularjs.org/guide/di) paradigm, without having to hand-write dependencies twice ourselves.

### Livereload

Livereload is enabled for development. Install the [chrome plugin](https://chrome.google.com/webstore/detail/livereload/jnihajbhpnppcggbcgedagnkighmdlei?hl=en) or similar to enjoy livereload of CSS, JS, and HTML files.

## Angular

We strive for a component-driven approach to our Angular organization. We have high-level folders for sections like checks and onboarding. Each folder structure should be the same. Always create the following:
- /partials
- /views
- controllers.js
- directives.js
- filters.js
- services.js
- module.js
Module.js should create the appropriate module by including all of the above.

Always wrap angular files in an Immediately-Invoked Function Expression to encourage local scope and proper dependency injection.

## SASS

SASS structure should be similar to the Angular structure, but even more component-driven. Components should have their own folder with at least a `_module.scss` that bundles all folder files. We also use [Compass](http://compass-style.org/) for some great helper functions.

## HTML Emails

Emails are generated through Jekyll and are run through an inliner that will ensure proper rendering. Source HTML is at `/_site/email`. Source CSS comes from `/scss-email`.